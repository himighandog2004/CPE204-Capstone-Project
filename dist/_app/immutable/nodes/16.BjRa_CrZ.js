import{t as x,a as N}from"../chunks/OnU_l3An.js";import"../chunks/BsN24l2h.js";import{p as nt,t as u,k as n,o as t,a as ct,j as d,w as K,m as h,s as l,x as Q,r as s,q as dt}from"../chunks/FB_gRupF.js";import{e as lt,s as p}from"../chunks/BkxHr61Q.js";import{i as V}from"../chunks/BydVSvHb.js";import{e as D,i as U}from"../chunks/BWNo7gSO.js";import{b as $}from"../chunks/DJRvsXZU.js";import{p as pt}from"../chunks/BDD76Zze.js";import{i as mt}from"../chunks/0NZHIKlb.js";import{o as ut}from"../chunks/SaxHpMRh.js";import{j as vt,i as gt,q as z,c as F,d as q,w as X,o as bt,g as yt,h as ft,s as _t}from"../chunks/CLR_ZPnl.js";var Nt=x("<option> </option>"),ht=x("<option> </option>"),xt=x('<div class="text-red-500"> </div>'),Tt=x('<div class="text-green-500"> </div>'),It=x("<tr><th></th><td> </td><td> </td><td> </td><td> </td></tr>"),St=x('<div class="p-5"><h1 class="text-3xl text-blue-600">Order Laboratory Test</h1> <p class="text-sm text-red-500">*Claim lab results at the Laboratory.</p> <form class="mb-6 flex flex-col gap-3 max-w-md mt-3 space-y-2"><select class="input input-bordered h-12" required><option disabled selected>Select Patient</option><!></select> <select class="input input-bordered h-12" required><option disabled selected>Select Lab Test</option><!></select> <button class="btn btn-primary" type="submit"> </button> <!> <!></form> <h2 class="text-xl mt-4">Recent Lab Orders</h2> <table class="table table-sm w-full mt-2"><thead><tr><th>#</th><td>Patient</td><td>Test</td><td>Status</td><td>Ordered</td></tr></thead><tbody></tbody></table></div>');function qt(J,W){nt(W,!1);let M=h([]),c=h({patient:"",test:"",status:"Ordered"}),T=h(!1),v=h(""),I=h(""),S=h([]),E=[{testName:"Complete Blood Count (CBC)",category:"Blood",price:350},{testName:"Blood Glucose Test",category:"Blood",price:200},{testName:"Lipid Profile",category:"Blood",price:600},{testName:"Liver Function Test (LFT)",category:"Blood",price:700},{testName:"Kidney Function Test (KFT)",category:"Blood",price:700},{testName:"Hemoglobin A1c (HbA1c)",category:"Blood",price:400},{testName:"Thyroid Function Test (T3, T4, TSH)",category:"Blood",price:800},{testName:"Urinalysis (Routine)",category:"Urine",price:150},{testName:"Urine Culture",category:"Urine",price:350},{testName:"Pregnancy Test (hCG)",category:"Urine",price:250},{testName:"24-Hour Urine Protein",category:"Urine",price:400},{testName:"Testosterone",category:"Hormone",price:500},{testName:"Estrogen",category:"Hormone",price:500},{testName:"Prolactin",category:"Hormone",price:500},{testName:"FSH LH",category:"Hormone",price:500},{testName:"Pap Smear",category:"Hormone",price:400},{testName:"PSA (Prostate-Specific Antigen)",category:"Hormone",price:600},{testName:"COVID-19 RT-PCR",category:"Infectious",price:1500},{testName:"HIV Test",category:"Infectious",price:600},{testName:"Hepatitis B/C Test",category:"Infectious",price:700},{testName:"Malaria Test",category:"Infectious",price:350},{testName:"Dengue NS1 Antigen Antibody",category:"Infectious",price:700},{testName:"X-Ray",category:"Imaging",price:800},{testName:"MRI Scan",category:"Imaging",price:5e3},{testName:"CT Scan",category:"Imaging",price:4e3},{testName:"ECG (Electrocardiogram)",category:"Imaging",price:500},{testName:"Ultrasound",category:"Imaging",price:1e3},{testName:"Stool Test",category:"Other",price:200}],b="";ut(async()=>{try{const e=vt(),a=e.currentUser;if(a?b=a.uid:await new Promise(g=>{const o=gt(e,f=>{f&&(b=f.uid,o(),g(void 0))})}),!b){l(v,"Please log in to access this page");return}const r=z(F(q,"laborders"),X("doctorID","==",b));bt(r,g=>{l(M,g.docs.map(o=>({id:o.id,...o.data()})).sort((o,f)=>{var _,P;return((_=f.createdAt)==null?void 0:_.seconds)-((P=o.createdAt)==null?void 0:P.seconds)}))});const i=z(F(q,"appointments"),X("doctorId","==",b)),m=await yt(i),y=new Map;m.docs.forEach(g=>{const o=g.data();o.patientId&&o.patientName&&y.set(o.patientId,{id:o.patientId,name:o.patientName})}),l(S,Array.from(y.values()))}catch(e){console.error("Error initializing lab orders:",e),l(v,"Failed to load patient data")}});async function Y(){if(l(v,""),l(I,""),!t(c).patient||!t(c).test){l(v,"Patient and test are required.");return}l(T,!0);try{const e=E.find(i=>i.testName===t(c).test),a=e?e.price:0,r=t(S).find(i=>i.name===t(c).patient);await ft(F(q,"laborders"),{...t(c),price:a,doctorID:b,patientId:r==null?void 0:r.id,createdAt:_t()}),l(I,"Lab order submitted!"),l(c,{patient:"",test:"",status:"Ordered"})}catch(e){console.error("Error submitting lab order:",e),l(v,"Failed to submit lab order.")}finally{l(T,!1)}}mt();var w=St(),O=d(n(w),4),A=n(O);u(()=>{t(c),Q(()=>{t(S)})});var B=n(A);B.value=B.__value="";var Z=d(B);D(Z,1,()=>t(S),U,(e,a)=>{var r=Nt(),i={},m=n(r,!0);s(r),u(()=>{i!==(i=t(a).name)&&(r.value=(r.__value=t(a).name)??""),p(m,t(a).name)}),N(e,r)}),s(A);var C=d(A,2);u(()=>{t(c),Q(()=>{})});var L=n(C);L.value=L.__value="";var tt=d(L);D(tt,1,()=>E,U,(e,a)=>{var r=ht(),i={},m=n(r);s(r),u(()=>{i!==(i=t(a).testName)&&(r.value=(r.__value=t(a).testName)??""),p(m,`${t(a).testName??""} (â‚±${t(a).price??""})`)}),N(e,r)}),s(C);var H=d(C,2),et=n(H,!0);s(H);var R=d(H,2);{var at=e=>{var a=xt(),r=n(a,!0);s(a),u(()=>p(r,t(v))),N(e,a)};V(R,e=>{t(v)&&e(at)})}var rt=d(R,2);{var ot=e=>{var a=Tt(),r=n(a,!0);s(a),u(()=>p(r,t(I))),N(e,a)};V(rt,e=>{t(I)&&e(ot)})}s(O);var G=d(O,4),j=d(n(G));D(j,5,()=>t(M),U,(e,a,r)=>{var i=It(),m=n(i);m.textContent=r+1;var y=d(m),g=n(y,!0);s(y);var o=d(y),f=n(o,!0);s(o);var _=d(o),P=n(_,!0);s(_);var k=d(_),st=n(k,!0);s(k),s(i),u(it=>{p(g,t(a).patient),p(f,t(a).test),p(P,t(a).status),p(st,it)},[()=>t(a).createdAt?new Date(t(a).createdAt.seconds*1e3).toLocaleString():"-"],dt),N(e,i)}),s(j),s(G),s(w),u(()=>{H.disabled=t(T),p(et,t(T)?"Ordering...":"Order Test")}),$(A,()=>t(c).patient,e=>K(c,t(c).patient=e)),$(C,()=>t(c).test,e=>K(c,t(c).test=e)),lt("submit",O,pt(Y)),N(J,w),ct()}export{qt as component};
