import{t as u,a as m}from"../chunks/OnU_l3An.js";import"../chunks/BsN24l2h.js";import{p as W,o as e,a as X,j as d,s as T,m as N,k as l,r as o,t as P,q as Y}from"../chunks/FB_gRupF.js";import{s as _,e as Q}from"../chunks/BkxHr61Q.js";import{i as R}from"../chunks/BydVSvHb.js";import{e as Z,i as $}from"../chunks/BWNo7gSO.js";import{r as tt}from"../chunks/B5V6kkOL.js";import{b as at}from"../chunks/D4IycTRD.js";import{i as et}from"../chunks/0NZHIKlb.js";import{o as st}from"../chunks/SaxHpMRh.js";import{c as C,d as n,o as rt,b as ot,e as D,u as lt,f as dt,q as it,w as j,g as nt,h as ct,s as pt}from"../chunks/CLR_ZPnl.js";var bt=u('<span class="badge badge-success">Completed</span>'),vt=u('<span class="badge badge-warning"> </span>'),mt=u('<button class="btn btn-xs btn-success ml-2" title="Resolve &amp; Bill">‚úîÔ∏è Resolve</button>'),ut=u('<tr><th></th><td> </td><td> </td><td> </td><td><!></td><td><button class="btn btn-xs btn-error" title="Delete">üóëÔ∏è</button> <!></td></tr>'),ft=u('<div class="p-5"><h1 class="text-3xl text-blue-600">Laboratory Orders</h1> <h2 class="text-xl mt-4">Lab Orders Overview</h2> <input type="text" placeholder="Search patient or test..." class="input input-sm my-2"> <div class="w-full h-105"><table class="table table-sm overflow-y-scroll overflow-x-auto"><thead><tr><th>#</th><td>Patient</td><td>Test</td><td>Ordered Date</td><td>Status</td><td>Actions</td></tr></thead><tbody></tbody></table></div></div>');function kt(B,M){W(M,!1);let L=N([]),f=N("");st(()=>{const a=C(n,"laborders");rt(a,t=>{T(L,t.docs.map(s=>({id:s.id,...s.data()})))})});async function z(a){confirm("Delete this lab order?")&&await ot(D(n,"laborders",a))}async function E(a){await lt(D(n,"laborders",a),{status:"Completed"});const t=await dt(D(n,"laborders",a));if(t.exists()){const s=t.data(),c=s.patient,p=s.test,b=s.price||0,w=s.patientId||"",v=it(C(n,"bills"),j("labOrderId","==",a),j("type","==","labtest"));(await nt(v)).empty&&await ct(C(n,"bills"),{patientName:c,patientId:w,type:"labtest",description:`Lab Test: ${p}`,amount:b,status:"pending",createdAt:pt(),labOrderId:a,testName:p})}}et();var h=ft(),x=d(l(h),4);tt(x);var O=d(x,2),S=l(O),k=d(l(S));Z(k,5,()=>e(L).filter(a=>{var t,s;return(((t=a.patient)==null?void 0:t.toLowerCase())||"").includes(e(f).toLowerCase())||(((s=a.test)==null?void 0:s.toLowerCase())||"").includes(e(f).toLowerCase())}),$,(a,t,s)=>{var c=ut(),p=l(c);p.textContent=s+1;var b=d(p),w=l(b,!0);o(b);var v=d(b),q=l(v,!0);o(v);var y=d(v),F=l(y,!0);o(y);var g=d(y),G=l(g);{var H=r=>{var i=bt();m(r,i)},J=r=>{var i=vt(),V=l(i,!0);o(i),P(()=>_(V,e(t).status)),m(r,i)};R(G,r=>{e(t).status==="Completed"?r(H):r(J,!1)})}o(g);var A=d(g),I=l(A),K=d(I,2);{var U=r=>{var i=mt();Q("click",i,()=>E(e(t).id)),m(r,i)};R(K,r=>{e(t).status!=="Completed"&&r(U)})}o(A),o(c),P(r=>{_(w,e(t).patient),_(q,e(t).test),_(F,r)},[()=>e(t).createdAt?new Date(e(t).createdAt.seconds*1e3).toLocaleString():"-"],Y),Q("click",I,()=>z(e(t).id)),m(a,c)}),o(k),o(S),o(O),o(h),at(x,()=>e(f),a=>T(f,a)),m(B,h),X()}export{kt as component};
