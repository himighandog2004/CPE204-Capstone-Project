import{t as u,a as p}from"../chunks/OnU_l3An.js";import"../chunks/BsN24l2h.js";import{p as qt,i as It,s as m,t as S,a as Nt,m as _,o as t,k as l,r as e,j as d,w as it,f as z,q as dt,l as B}from"../chunks/FB_gRupF.js";import{s as g,e as Et}from"../chunks/BkxHr61Q.js";import{i as D}from"../chunks/BydVSvHb.js";import{e as F,i as G}from"../chunks/BWNo7gSO.js";import{i as Qt}from"../chunks/0NZHIKlb.js";import{a as Vt}from"../chunks/SaxHpMRh.js";import{i as jt,j as Ht,q as J,w as K,c as W,d as L,o as Mt,g as nt,f as Ot,e as ct,u as Ut}from"../chunks/CLR_ZPnl.js";var zt=u('<li class="bg-[#1f1f1f] p-3 rounded-lg"><div class="font-medium"> </div> <div class="text-sm text-gray-400"> </div></li>'),Bt=u('<ul class="space-y-2"></ul> <a href="/dashboard/doctor/sidebar/Appointmentlist" class="inline-block mt-4 text-blue-400 underline text-sm">View All Appointments</a>',1),Ft=u('<p class="text-gray-400">No upcoming appointments.</p>'),Gt=u('<p class="text-gray-400">Loading patients...</p>'),Jt=u('<li class="bg-[#1f1f1f] p-3 rounded-lg"><div class="font-medium"> </div> <div class="text-sm text-gray-400"> </div></li>'),Kt=u('<ul class="space-y-2"></ul> <a href="/dashboard/doctor/sidebar/Mpatient" class="inline-block mt-4 text-blue-400 underline text-sm">View All Patients</a>',1),Wt=u('<p class="text-gray-400">No patients found.</p>'),Xt=u('<p class="text-gray-400">Loading lab results...</p>'),Yt=u('<li class="bg-[#1f1f1f] p-3 rounded-lg"><div class="font-medium"> </div> <div class="text-sm text-blue-400 font-semibold">Lab Result ready for Pick-up</div> <div class="text-sm text-gray-400"> </div> <div class="mt-2"><button class="bg-green-500 hover:bg-green-600 text-white text-sm px-3 py-1 rounded-md transition-colors">Resolve</button></div></li>'),Zt=u('<ul class="space-y-2"></ul> <a href="/dashboard/doctor/sidebar/laborder" class="inline-block mt-4 text-blue-400 underline text-sm">View All Lab Results</a>',1),$t=u('<p class="text-gray-400">No completed lab results found.</p>'),ta=u('<div class="p-6 w-full h-full text-white bg-[#181818] space-y-6"><h1 class="text-3xl font-bold"> </h1> <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"><div class="bg-[#2c2c2c] rounded-2xl p-6 shadow-lg"><h2 class="text-xl font-semibold mb-4">Upcoming Appointments</h2> <!></div> <div class="bg-[#2c2c2c] rounded-2xl p-6 shadow-lg"><h2 class="text-xl font-semibold mb-4">Patients</h2> <!></div> <div class="bg-[#2c2c2c] rounded-2xl p-6 shadow-lg"><h2 class="text-xl font-semibold mb-4">Lab Test Results</h2> <!></div></div> <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6 mt-10"><div class="bg-[#2c2c2c] rounded-2xl p-6 shadow-lg"><h3 class="text-sm text-gray-400">Total Patients</h3> <p class="text-2xl font-bold mt-2"> </p></div> <div class="bg-[#2c2c2c] rounded-2xl p-6 shadow-lg"><h3 class="text-sm text-gray-400">Completed Appointments</h3> <p class="text-2xl font-bold mt-2"> </p></div> <div class="bg-[#2c2c2c] rounded-2xl p-6 shadow-lg"><h3 class="text-sm text-gray-400">Pending Appointments</h3> <p class="text-2xl font-bold mt-2"> </p></div> <div class="bg-[#2c2c2c] rounded-2xl p-6 shadow-lg"><h3 class="text-sm text-gray-400">Lab Tests Ordered</h3> <p class="text-2xl font-bold mt-2"> </p></div></div></div>');function ca(vt,pt){qt(pt,!1);let X=_(""),R=_([]),y=_([]),h=_([]),C=_(0),Y=_(0),Z=_(0),q=_(0),w=_({patients:!0,labResults:!0});const P=It("userName");let k;P!=null&&P.subscribe&&(k=P.subscribe(a=>{m(X,a)}));let T="";async function mt(a){try{const s=J(W(L,"appointments"),K("doctorId","==",a)),v=await nt(s),r=[...new Set(v.docs.map(i=>i.data().patientId).filter(i=>i&&i.trim()!==""))];if(r.length===0){m(y,[]),m(C,0);return}const o=r.map(async i=>{const f=await Ot(ct(L,"users",i));if(f.exists()){const c=f.data();return{id:f.id,name:c.name,surname:c.surname,...c}}return null}),n=await Promise.all(o);m(y,n.filter(i=>i!==null&&i.name)),m(C,t(y).length),console.log("Loaded patients:",t(y).length)}catch(s){console.error("Error loading patients:",s)}finally{it(w,t(w).patients=!1)}}async function ut(a){try{const s=J(W(L,"laborders"),K("doctorID","==",a)),v=await nt(s);m(h,v.docs.map(r=>({id:r.id,...r.data()})).filter(r=>r.status==="Completed")),m(q,t(h).length)}catch(s){console.error("Error loading lab results:",s)}finally{it(w,t(w).labResults=!1)}}async function gt(a){try{const s=ct(L,"laborders",a);await Ut(s,{status:"Resolved"}),m(h,t(h).filter(v=>v.id!==a)),m(q,t(h).length)}catch(s){console.error("Error resolving lab result:",s)}}jt(Ht(),a=>{if(a){T=a.uid;const s=J(W(L,"appointments"),K("doctorId","==",T));Mt(s,v=>{m(R,v.docs.map(r=>({id:r.id,...r.data()}))),m(Y,t(R).filter(r=>r.status==="Completed").length),m(Z,t(R).filter(r=>r.status==="Pending").length),mt(T)}),ut(T)}}),Vt(()=>{k==null||k()}),Qt();var I=ta(),N=l(I),ft=l(N);e(N);var E=d(N,2),Q=l(E),xt=d(l(Q),2);{var bt=a=>{var s=Bt(),v=z(s);F(v,5,()=>[...t(R)].sort((r,o)=>new Date(o.date).getTime()-new Date(r.date).getTime()).slice(0,2),G,(r,o)=>{var n=zt(),i=l(n),f=l(i,!0);e(i);var c=d(i,2),x=l(c);e(c),e(n),S(b=>{g(f,t(o).patientName),g(x,`${b??""}
                • ${t(o).status??""}`)},[()=>t(o).date?new Date(t(o).date).toLocaleString():"-"],dt),p(r,n)}),e(v),B(2),p(a,s)},_t=a=>{var s=Ft();p(a,s)};D(xt,a=>{t(R).length>0?a(bt):a(_t,!1)})}e(Q);var V=d(Q,2),ht=d(l(V),2);{var yt=a=>{var s=Gt();p(a,s)},wt=(a,s)=>{{var v=o=>{var n=Kt(),i=z(n);F(i,5,()=>t(y).slice(0,2),G,(f,c)=>{var x=Jt(),b=l(x),O=l(b,!0);e(b);var A=d(b,2),U=l(A,!0);e(A),e(x),S(()=>{g(O,t(c).name),g(U,t(c).email)}),p(f,x)}),e(i),B(2),p(o,n)},r=o=>{var n=Wt();p(o,n)};D(a,o=>{t(y).length>0?o(v):o(r,!1)},s)}};D(ht,a=>{t(w).patients?a(yt):a(wt,!1)})}e(V);var $=d(V,2),At=d(l($),2);{var Rt=a=>{var s=Xt();p(a,s)},Dt=(a,s)=>{{var v=o=>{var n=Zt(),i=z(n);F(i,5,()=>t(h).slice(0,1),G,(f,c)=>{var x=Yt(),b=l(x),O=l(b);e(b);var A=d(b,4),U=l(A);e(A);var ot=d(A,2),St=l(ot);e(ot),e(x),S(Ct=>{g(O,`Patient: ${t(c).patient??""}`),g(U,`Test: ${t(c).test??""} • 
                Date: ${Ct??""}`)},[()=>t(c).createdAt?new Date(t(c).createdAt.seconds*1e3).toLocaleString():"-"],dt),Et("click",St,()=>gt(t(c).id)),p(f,x)}),e(i),B(2),p(o,n)},r=o=>{var n=$t();p(o,n)};D(a,o=>{t(h).length>0?o(v):o(r,!1)},s)}};D(At,a=>{t(w).labResults?a(Rt):a(Dt,!1)})}e($),e(E);var tt=d(E,2),j=l(tt),at=d(l(j),2),Lt=l(at,!0);e(at),e(j);var H=d(j,2),et=d(l(H),2),Pt=l(et,!0);e(et),e(H);var M=d(H,2),st=d(l(M),2),kt=l(st,!0);e(st),e(M);var lt=d(M,2),rt=d(l(lt),2),Tt=l(rt,!0);e(rt),e(lt),e(tt),e(I),S(()=>{g(ft,`Hello, Dr. ${t(X)??""}`),g(Lt,t(C)),g(Pt,t(Y)),g(kt,t(Z)),g(Tt,t(q))}),p(vt,I),Nt()}export{ca as component};
