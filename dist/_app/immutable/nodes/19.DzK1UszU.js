import{t as c,a as p}from"../chunks/OnU_l3An.js";import"../chunks/BsN24l2h.js";import{p as tt,a as at,s as i,m as F,j as d,k as r,o as e,r as s,t as R,q as et}from"../chunks/FB_gRupF.js";import{s as u,e as st}from"../chunks/BkxHr61Q.js";import{i as y}from"../chunks/BydVSvHb.js";import{e as rt,i as ot}from"../chunks/BWNo7gSO.js";import{s as nt}from"../chunks/CjvYOB0v.js";import{i as it}from"../chunks/0NZHIKlb.js";import{o as lt,a as pt}from"../chunks/SaxHpMRh.js";import{j as dt,i as ct,q as vt,c as mt,d as I,w as ut,o as ft,e as xt,u as ht}from"../chunks/CLR_ZPnl.js";var bt=c('<p class="text-red-400"> </p>'),yt=c('<p class="text-gray-400">Loading appointments...</p>'),_t=c('<button class="btn btn-soft btn-error">Cancel</button>'),gt=c('<span class="text-gray-500">-</span>'),wt=c('<tr class="border-b border-[#3a3a3a] hover:bg-[#1f1f1f]"><td class="px-4 py-3"> </td><td class="px-4 py-3"> </td><td class="px-4 py-3"> </td><td class="px-4 py-3"> </td><td class="px-4 py-3"><span> </span></td><td class="px-4 py-3"><!></td></tr>'),Dt=c('<div class="overflow-x-auto overflow-y-auto"><table class="min-w-full text-left text-sm"><thead class="bg-[#181818] text-gray-300 uppercase text-xs"><tr><th class="px-4 py-3">Date</th><th class="px-4 py-3">Time</th><th class="px-4 py-3">Doctor</th><th class="px-4 py-3">Reason</th><th class="px-4 py-3">Status</th><th class="px-4 py-3">Actions</th></tr></thead><tbody></tbody></table></div>'),At=c('<p class="text-gray-400">You have no appointments yet.</p>'),Ct=c('<div class="p-6 bg-[#2c2c2c] rounded-2xl shadow-md text-white h-140"><h2 class="text-2xl font-bold mb-4 text-white">My Appointments</h2> <!> <!></div>');function It(Q,T){tt(T,!1);let _=F([]),f=F(!0),m=F(null),g;function U(t){return t?(t.toDate?t.toDate():new Date(t)).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}):"-"}async function Y(t){try{const a=xt(I,"appointments",t);await ht(a,{status:"Cancelled"})}catch(a){console.error("Error cancelling appointment:",a),i(m,"Failed to cancel appointment")}}lt(()=>{const t=dt();ct(t,a=>{if(!a){i(m,"Please login to view your appointments"),i(f,!1);return}try{const v=vt(mt(I,"appointments"),ut("patientId","==",a.uid));g=ft(v,x=>{i(_,x.docs.map(n=>({id:n.id,...n.data()}))),i(f,!1)},x=>{console.error("Error fetching appointments:",x),i(m,"Failed to load appointments"),i(f,!1)})}catch(v){console.error("Error in appointment setup:",v),i(m,"Failed to setup appointment listener"),i(f,!1)}})}),pt(()=>{g&&g()}),it();var w=Ct(),P=d(r(w),2);{var z=t=>{var a=bt(),v=r(a,!0);s(a),R(()=>u(v,e(m))),p(t,a)};y(P,t=>{e(m)&&t(z)})}var B=d(P,2);{var G=t=>{var a=yt();p(t,a)},H=(t,a)=>{{var v=n=>{var h=Dt(),j=r(h),L=d(r(j));rt(L,5,()=>e(_),ot,(J,o)=>{var D=wt(),A=r(D),K=r(A,!0);s(A);var C=d(A),N=r(C,!0);s(C);var S=d(C),O=r(S,!0);s(S);var q=d(S),V=r(q,!0);s(q);var k=d(q),E=r(k),W=r(E,!0);s(E),s(k);var M=d(k),X=r(M);{var Z=l=>{var b=_t();st("click",b,()=>Y(e(o).id)),p(l,b)},$=l=>{var b=gt();p(l,b)};y(X,l=>{e(o).status==="Pending"?l(Z):l($,!1)})}s(M),s(D),R(l=>{u(K,l),u(N,e(o).time),u(O,e(o).doctor),u(V,e(o).reason),nt(E,1,`px-2 py-1 rounded-full text-xs font-semibold
                  ${e(o).status==="Pending"?"badge badge-warning":""}
                  ${e(o).status==="Completed"?"badge badge-success":""}
                  ${e(o).status==="Cancelled"?"badge badge-error":""}`),u(W,e(o).status)},[()=>U(e(o).date)],et),p(J,D)}),s(L),s(j),s(h),p(n,h)},x=n=>{var h=At();p(n,h)};y(t,n=>{e(_).length>0?n(v):n(x,!1)},a)}};y(B,t=>{e(f)?t(G):t(H,!1)})}s(w),p(Q,w),at()}export{It as component};
