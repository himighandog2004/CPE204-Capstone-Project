import{t as S,a as y}from"../chunks/OnU_l3An.js";import"../chunks/BsN24l2h.js";import{p as pt,i as _t,s as n,u as ht,v as xt,t as O,o as t,a as gt,m as _,k as d,j as o,r as s,q as wt}from"../chunks/FB_gRupF.js";import{e as A,s as u}from"../chunks/BkxHr61Q.js";import{i as yt}from"../chunks/BydVSvHb.js";import{e as At,i as St}from"../chunks/BWNo7gSO.js";import{r as Ct}from"../chunks/B5V6kkOL.js";import{s as kt}from"../chunks/CjvYOB0v.js";import{b as Dt}from"../chunks/D4IycTRD.js";import{i as Lt}from"../chunks/0NZHIKlb.js";import{a as Pt}from"../chunks/SaxHpMRh.js";import{b as Tt,e as Ft,d as jt,j as Nt,p as zt}from"../chunks/CLR_ZPnl.js";var Kt=S('<div class="badge badge-success">Active</div>'),Rt=S('<div class="badge badge-error">Inactive</div>'),Ut=S('<tr style="cursor:pointer;"><th></th><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td><!></td></tr>'),Vt=S('<div class="flex flex-col h-full w-full"><div class="bg-[#102e50] rounded-t-xl p-2 pt-3 px-4"><div class="flex flex-row w-full justify-between"><h1 class="text-3xl text-white">Patient List</h1> <a href="/dashboard/admin/sidebar/appointments" class="text-xl text-white underline mt-1 mr-2">View Appointments</a></div> <div class="flex justify-between items-center mb-3 pr-2 mt-2"><input type="text" placeholder="Search name, email, or phone..." class="input input-sm w-1/2"> <div class="space-x-2"><button class="btn btn-xs btn-soft btn-success">Sort by Name</button> <button class="btn btn-xs btn-soft btn-success">Sort by Date</button> <button class="btn btn-xs btn-soft btn-error">Remove Patient</button></div></div></div> <hr class="border-t-2 border-black"> <div class="bg-[#2c2c2c] rounded-b-xl p-5"><div class="overflow-x-auto overflow-y-scroll w-full h-108 bg-base-100 rounded-lg"><table class="table table-sm table-pin-rows table-pin-cols"><thead><tr><th>#</th><td class="w-50">Name</td><td>Birthdate</td><td>Age</td><td>Sex</td><td>Phone</td><td>Address</td><td>Email</td><td>Date Registered</td><td>Status</td></tr></thead><tbody></tbody></table></div></div></div>');function Xt(X,Y){pt(Y,!1);const C=_();let k=_([]);const x=_t("patients");let D;x&&typeof x.subscribe=="function"&&(D=x.subscribe(e=>{n(k,e)})),Pt(()=>{D&&D()});let v=_(""),f=_(""),m=_(!0),i=_(new Set),b=null;function q(e){t(f)===e?n(m,!t(m)):(n(f,e),n(m,!0))}function g(e){return(e==null?void 0:e.toLowerCase().replace(/\b\w/g,a=>a.toUpperCase()))??""}function Z(e,a,r){if(e.shiftKey&&b!==null){const l=Math.min(b,r),w=Math.max(b,r);for(let p=l;p<=w;p++)t(i).add(t(C)[p].id)}else e.ctrlKey||e.metaKey?(t(i).has(a)?t(i).delete(a):t(i).add(a),b=r):(n(i,new Set([a])),b=r)}async function tt(){if(t(i).size!==0){for(const e of t(i)){try{await Tt(Ft(jt,"users",e))}catch(a){console.error("Failed to delete patient in Firestore:",a)}try{const r=Nt().currentUser;r&&r.uid===e&&await zt(r)}catch(a){console.error("Failed to delete user from Firebase Auth:",a)}}x.update(e=>e.filter(a=>!t(i).has(a.id))),n(i,new Set),b=null}}ht(()=>(t(k),t(v),t(f),t(m)),()=>{n(C,[...t(k)].filter(e=>{var r,l;return`${e.name} ${e.surname}`.toLowerCase().includes(t(v).toLowerCase())||((r=e.email)==null?void 0:r.toLowerCase().includes(t(v).toLowerCase()))||((l=e.phone)==null?void 0:l.includes(t(v)))}).map(e=>({...e,createdAt:e.createdAt?new Date(e.createdAt):new Date(0)})).sort((e,a)=>{if(!t(f))return a.createdAt.getTime()-e.createdAt.getTime();const r=e[t(f)]??"",l=a[t(f)]??"";return typeof r=="string"&&typeof l=="string"?t(m)?r.localeCompare(l):l.localeCompare(r):e.createdAt&&a.createdAt?t(m)?e.createdAt.getTime()-a.createdAt.getTime():a.createdAt.getTime()-e.createdAt.getTime():0}))}),xt(),Lt();var L=Vt(),P=d(L),M=o(d(P),2),T=d(M);Ct(T);var $=o(T,2),B=d($),E=o(B,2),Q=o(E,2);s($),s(M),s(P);var W=o(P,4),G=d(W),H=d(G),I=o(d(H));At(I,5,()=>t(C),St,(e,a,r)=>{var l=Ut();let w;var p=d(l);p.textContent=r+1;var F=o(p),et=d(F);s(F);var j=o(F),at=d(j,!0);s(j);var N=o(j),rt=d(N,!0);s(N);var z=o(N),st=d(z,!0);s(z);var K=o(z),dt=d(K,!0);s(K);var R=o(K),ot=d(R,!0);s(R);var U=o(R),lt=d(U,!0);s(U);var V=o(U),it=d(V,!0);s(V);var J=o(V),ct=d(J);{var nt=c=>{var h=Kt();y(c,h)},ut=c=>{var h=Rt();y(c,h)};yt(ct,c=>{t(a).isActive===!0?c(nt):c(ut,!1)})}s(J),s(l),O((c,h,vt,ft,mt,bt)=>{w=kt(l,1,"svelte-rte76n",null,w,c),u(et,`${h??""} ${vt??""}`),u(at,t(a).birthdate||"-"),u(rt,t(a).age??"-"),u(st,ft),u(dt,t(a).phone||"-"),u(ot,mt),u(lt,t(a).email||"-"),u(it,bt)},[()=>({selected:t(i).has(t(a).id)}),()=>g(t(a).name),()=>g(t(a).surname),()=>g(t(a).sex)||"-",()=>g(t(a).address)||"-",()=>t(a).createdAt?new Date(t(a).createdAt).toLocaleDateString():"-"],wt),A("click",l,c=>Z(c,t(a).id,r)),y(e,l)}),s(I),s(H),s(G),s(W),s(L),O(()=>Q.disabled=t(i).size===0),Dt(T,()=>t(v),e=>n(v,e)),A("click",B,()=>q("name")),A("click",E,()=>q("createdAt")),A("click",Q,tt),y(X,L),gt()}export{Xt as component};
