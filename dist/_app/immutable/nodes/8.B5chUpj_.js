import{t as y,a as _}from"../chunks/OnU_l3An.js";import"../chunks/BsN24l2h.js";import{p as Ye,i as Ze,s,u as et,v as tt,t as z,k as o,o as e,a as at,m as n,j as i,r as l,x as rt,q as st}from"../chunks/FB_gRupF.js";import{e as P,s as p}from"../chunks/BkxHr61Q.js";import{i as oe}from"../chunks/BydVSvHb.js";import{e as Ce,i as ze}from"../chunks/BWNo7gSO.js";import{r as h}from"../chunks/B5V6kkOL.js";import{s as lt}from"../chunks/CjvYOB0v.js";import{b as w}from"../chunks/D4IycTRD.js";import{b as ot}from"../chunks/DJRvsXZU.js";import{p as it}from"../chunks/BDD76Zze.js";import{i as dt}from"../chunks/0NZHIKlb.js";import{a as nt}from"../chunks/SaxHpMRh.js";import{b as ct,e as ke,d as Fe,j as Le,p as ut,r as vt,k as pt,s as mt}from"../chunks/CLR_ZPnl.js";var ft=y("<option> </option>"),bt=y('<div class="text-red-500 text-sm"> </div>'),_t=y('<div class="text-green-500 text-sm"> </div>'),ht=y('<div class="badge badge-sm badge-success">Active</div>'),wt=y('<div class="badge badge-sm badge-error">Inactive</div>'),yt=y('<tr style="cursor:pointer;"><th></th><td class="overflow-hidden svelte-1jmm9az"> </td><td class="overflow-hidden svelte-1jmm9az"> </td><td class="overflow-hidden svelte-1jmm9az"> </td><td class="overflow-hidden svelte-1jmm9az"> </td><td class="overflow-hidden svelte-1jmm9az"> </td><td><!></td></tr>'),xt=y('<div class="flex flex-row h-145 w-full justify-between items-between"><div class="flex flex-col w-115"><div class="flex flex-row w-[100%] justify-between"><h1 class="text-3xl text-white">List of Doctors</h1></div> <div class="flex justify-start items-start mt-5"><form class="flex flex-col items-start justify-start space-y-8"><div class="flex flex-row space-x-2"><label class="input input-neutral"><input class="grow" type="text" required placeholder="First Name"></label> <label class="input input-neutral"><input class="grow" type="text" required placeholder="Last Name"></label></div> <div class="dropdown dropdown-center"><select class="btn btn-accent w-100 h-11" required><option disabled selected>- Select Specialization -</option><!></select></div> <label class="input input-neutral"><input class="grow" type="text" required placeholder="Email"></label> <label class="input input-neutral"><input class="grow" type="number" placeholder="Phone Number"></label> <label class="input input-neutral overflow-hidden"><input class="grow" type="text" placeholder="Address"></label> <label class="input input-neutral"><input class="grow" type="password" placeholder="Password (Blank: cloudward)"></label> <button class="btn btn-soft btn-success w-full mt-2" type="submit"> </button> <!> <!></form></div></div> <div class="flex flex-col bg-[#2c2c2c] p-3 pt-2 rounded-xl w-[60%]"><div class="flex justify-between items-center mb-3 pr-2 mt-2"><input type="text" placeholder="Search name, email, or phone..." class="input input-sm input-bordered w-1/2"> <div class="space-x-2"><button class="btn btn-soft btn-success btn-xs">Sort by Name</button> <button class="btn btn-soft btn-success btn-xs">Sort by Date</button> <button class="btn btn-soft btn-error btn-xs">Remove Doctor</button></div></div> <div class="overflow-x-auto overflow-y-scroll w-full h-128 bg-base-100 rounded-lg"><table class="table table-xs table-pin-rows table-pin-cols"><thead><tr><th>#</th><td class="w-40">Name</td><td>Specialty</td><td>Phone</td><td>Address</td><td>Email</td><td>Status</td></tr></thead><tbody></tbody></table></div></div></div>');function Mt(Ne,Pe){Ye(Pe,!1);const R=n();let E=n([]);const k=Ze("doctors");let K;k&&typeof k.subscribe=="function"&&(K=k.subscribe(t=>{s(E,t)})),nt(()=>{K&&K()});let x=n(""),g=n(""),m=n(""),f=n(""),T=n(""),F=n(""),L=n(""),b=n(""),q=n(""),M=n(!1);const Te=["General Medicine","Pediatrics","Cardiology","Neurology","Orthopedics","Dermatology","Psychiatry","Other"];async function qe(){s(b,""),s(q,""),s(M,!0);try{if(!e(x)||!e(g)||!e(m)||!e(f)){s(b,"Please fill in all required fields.");return}const t=Le(),a=e(T).trim()||"cloudward";let r;try{r=await vt(t,e(f),a)}catch(u){u.code==="auth/email-already-in-use"?s(b,"This email is already registered."):(s(b,"Failed to register doctor in Auth."),console.error("Auth error:",u));return}const d=r.user.uid;await pt(ke(Fe,"users",d),{name:e(x),surname:e(g),specialty:e(m),email:e(f),phone:e(F)||"",address:e(L)||"",role:"Doctor",isActive:!1,createdAt:mt(),uid:d}),k.update(u=>[...u,{id:d,name:e(x),surname:e(g),specialty:e(m),email:e(f),phone:e(F)||"",address:e(L)||"",role:"Doctor",isActive:!0,createdAt:new Date,uid:d}]),s(q,"Doctor registered successfully!"),s(x,""),s(g,""),s(m,""),s(f,""),s(F,""),s(L,""),s(T,"")}catch(t){s(b,"Failed to register doctor."),console.error("Unexpected error:",t)}finally{s(M,!1)}}let A=n(""),D=n(""),S=n(!0);function ie(t){e(D)===t?s(S,!e(S)):(s(D,t),s(S,!0))}function de(t){return(t==null?void 0:t.toLowerCase().replace(/\b\w/g,a=>a.toUpperCase()))??""}let c=n(new Set),j=null;function Me(t,a,r){if(t.shiftKey&&j!==null){const d=Math.min(j,r),u=Math.max(j,r);for(let C=d;C<=u;C++)e(c).add(e(R)[C].id)}else t.ctrlKey||t.metaKey?(e(c).has(a)?e(c).delete(a):e(c).add(a),j=r):(s(c,new Set([a])),j=r)}async function Ue(){if(e(c).size!==0){for(const t of e(c)){try{await ct(ke(Fe,"users",t))}catch(a){console.error("Failed to delete doctor in Firestore:",a)}try{const r=Le().currentUser;r&&r.uid===t&&await ut(r)}catch(a){console.error("Failed to delete user from Firebase Auth:",a)}}k.update(t=>t.filter(a=>!e(c).has(a.id))),s(c,new Set),j=null}}et(()=>(e(E),e(A),e(D),e(S)),()=>{s(R,[...e(E)].filter(t=>{var r,d;return`${t.name} ${t.surname}`.toLowerCase().includes(e(A).toLowerCase())||((r=t.email)==null?void 0:r.toLowerCase().includes(e(A).toLowerCase()))||((d=t.phone)==null?void 0:d.includes(e(A)))}).map(t=>({...t,createdAt:t.createdAt?new Date(t.createdAt):new Date(0)})).sort((t,a)=>{if(!e(D))return a.createdAt.getTime()-t.createdAt.getTime();const r=t[e(D)]??"",d=a[e(D)]??"";return typeof r=="string"&&typeof d=="string"?e(S)?r.localeCompare(d):d.localeCompare(r):t.createdAt&&a.createdAt?e(S)?t.createdAt.getTime()-a.createdAt.getTime():a.createdAt.getTime()-t.createdAt.getTime():0}))}),tt(),dt();var O=xt(),V=o(O),ne=i(o(V),2),W=o(ne),$=o(W),B=o($),ce=o(B);h(ce),l(B);var ue=i(B,2),ve=o(ue);h(ve),l(ue),l($);var G=i($,2),Q=o(G);z(()=>{e(m),rt(()=>{})});var H=o(Q);H.value=H.__value="";var Re=i(H);Ce(Re,1,()=>Te,ze,(t,a)=>{var r=ft(),d={},u=o(r,!0);l(r),z(()=>{d!==(d=e(a))&&(r.value=(r.__value=e(a))??""),p(u,e(a))}),_(t,r)}),l(Q),l(G);var I=i(G,2),pe=o(I);h(pe),l(I);var J=i(I,2),me=o(J);h(me),l(J);var X=i(J,2),fe=o(X);h(fe),l(X);var Y=i(X,2),be=o(Y);h(be),l(Y);var U=i(Y,2),Ee=o(U,!0);l(U);var _e=i(U,2);{var Ke=t=>{var a=bt(),r=o(a,!0);l(a),z(()=>p(r,e(b))),_(t,a)};oe(_e,t=>{e(b)&&t(Ke)})}var Oe=i(_e,2);{var Ve=t=>{var a=_t(),r=o(a,!0);l(a),z(()=>p(r,e(q))),_(t,a)};oe(Oe,t=>{e(q)&&t(Ve)})}l(W),l(ne),l(V);var he=i(V,2),Z=o(he),ee=o(Z);h(ee);var we=i(ee,2),ye=o(we),xe=i(ye,2),ge=i(xe,2);l(we),l(Z);var Ae=i(Z,2),De=o(Ae),Se=i(o(De));Ce(Se,5,()=>e(R),ze,(t,a,r)=>{var d=yt();let u;var C=o(d);C.textContent=r+1;var te=i(C),We=o(te);l(te);var ae=i(te),$e=o(ae,!0);l(ae);var re=i(ae),Be=o(re,!0);l(re);var se=i(re),Ge=o(se,!0);l(se);var le=i(se),Qe=o(le,!0);l(le);var je=i(le),He=o(je);{var Ie=v=>{var N=ht();_(v,N)},Je=v=>{var N=wt();_(v,N)};oe(He,v=>{e(a).isActive===!0?v(Ie):v(Je,!1)})}l(je),l(d),z((v,N,Xe)=>{u=lt(d,1,"svelte-1jmm9az",null,u,v),p(We,`Dr. ${N??""} ${Xe??""}`),p($e,e(a).specialty||"-"),p(Be,e(a).phone||"-"),p(Ge,e(a).address||"-"),p(Qe,e(a).email||"-")},[()=>({selected:e(c).has(e(a).id)}),()=>de(e(a).name),()=>de(e(a).surname)],st),P("click",d,v=>Me(v,e(a).id,r)),_(t,d)}),l(Se),l(De),l(Ae),l(he),l(O),z(()=>{U.disabled=e(M),p(Ee,e(M)?"Registering...":"Register Doctor"),ge.disabled=e(c).size===0}),w(ce,()=>e(x),t=>s(x,t)),w(ve,()=>e(g),t=>s(g,t)),ot(Q,()=>e(m),t=>s(m,t)),w(pe,()=>e(f),t=>s(f,t)),w(me,()=>e(F),t=>s(F,t)),w(fe,()=>e(L),t=>s(L,t)),w(be,()=>e(T),t=>s(T,t)),P("submit",W,it(qe)),w(ee,()=>e(A),t=>s(A,t)),P("click",ye,()=>ie("name")),P("click",xe,()=>ie("createdAt")),P("click",ge,Ue),_(Ne,O),at()}export{Mt as component};
