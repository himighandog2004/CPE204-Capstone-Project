import{t as _,a as p}from"../chunks/OnU_l3An.js";import"../chunks/BsN24l2h.js";import{p as ct,u as ut,v as bt,o as t,a as vt,k as r,j as o,s as b,m,r as s,t as pt}from"../chunks/FB_gRupF.js";import{e as f,s as w}from"../chunks/BkxHr61Q.js";import{i as J}from"../chunks/BydVSvHb.js";import{e as mt,i as ft}from"../chunks/BWNo7gSO.js";import{r as _t}from"../chunks/B5V6kkOL.js";import{b as xt}from"../chunks/D4IycTRD.js";import{i as yt}from"../chunks/0NZHIKlb.js";import{o as wt,a as gt}from"../chunks/SaxHpMRh.js";import{q as K,a as ht,c as O,d as g,o as Ct,w as R,g as St,b as U,e as W}from"../chunks/CLR_ZPnl.js";var Dt=_('<div class="badge badge-success">Completed</div>'),At=_('<div class="badge badge-warning">Pending</div>'),Pt=_('<div class="badge badge-error">Cancelled</div>'),kt=_('<tr><th></th><td> </td><td> </td><td> </td><td> </td><td><!></td><td><button class="btn btn-xs btn-error" title="Delete">üóëÔ∏è</button></td></tr>'),Lt=_('<div class="flex flex-col h-full w-full"><div class="bg-gray-700 rounded-xl shadow-lg p-4"><div class="flex flex-row w-full justify-between"><h1 class="text-3xl text-white">Appointment List</h1> <a href="/dashboard/admin/sidebar/patientlist" class="text-xl text-white underline mt-1 mr-2">View Patients list</a></div> <div class="flex justify-between items-center mb-3 pr-2 mt-2"><input type="text" placeholder="Search by patient name, date, status, or doctor..." class="input input-sm input-bordered w-1/2"> <div class="space-x-2"><button class="btn btn-xs">Sort by Patient Name</button> <button class="btn btn-xs">Sort by Date</button> <button class="btn btn-xs">Sort by Status</button> <button class="btn btn-xs">Sort by Doctor</button></div></div> <div class="overflow-x-auto overflow-y-scroll w-full h-115 bg-base-100 rounded-lg"><table class="table table-sm table-pin-rows table-pin-cols"><thead><tr><th>#</th><td class="w-50">Patient Name</td><td>Date</td><td>Time</td><td>Doctor</td><td>Status</td><td>Actions</td></tr></thead><tbody></tbody></table></div></div></div>');function Et(X,Y){ct(Y,!1);const V=m();let h=m([]),C;wt(()=>{const e=K(O(g,"appointments"),ht("createdAt","desc"));C=Ct(e,a=>{b(h,a.docs.map(i=>({id:i.id,...i.data()})))})}),gt(()=>{C&&C()});let d=m(""),n=m(""),v=m(!0);function x(e){t(n)===e?b(v,!t(v)):(b(n,e),b(v,!0))}async function Z(e){if(confirm("Are you sure you want to delete this appointment?"))try{const a=K(O(g,"bills"),R("appointmentId","==",e),R("type","==","appointment")),l=(await St(a)).docs.map(y=>U(W(g,"bills",y.id)));await Promise.all(l),await U(W(g,"appointments",e))}catch(a){console.error("Failed to delete appointment:",a),alert("Failed to delete appointment. Please try again.")}}ut(()=>(t(h),t(d),t(n),t(v)),()=>{b(V,[...t(h)].filter(e=>e.patientName.toLowerCase().includes(t(d).toLowerCase())||e.date.includes(t(d))||e.status.toLowerCase().includes(t(d).toLowerCase())||e.doctor.toLowerCase().includes(t(d))).sort((e,a)=>{if(!t(n))return 0;const i=e[t(n)]??"",l=a[t(n)]??"";return typeof i=="string"&&typeof l=="string"?t(v)?i.localeCompare(l):l.localeCompare(i):0}))}),bt(),yt();var S=Lt(),Q=r(S),D=o(r(Q),2),A=r(D);_t(A);var B=o(A,2),I=r(B),M=o(I,2),T=o(M,2),$=o(T,2);s(B),s(D);var z=o(D,2),E=r(z),G=o(r(E));mt(G,5,()=>t(V),ft,(e,a,i)=>{var l=kt(),y=r(l);y.textContent=i+1;var P=o(y),tt=r(P,!0);s(P);var k=o(P),et=r(k,!0);s(k);var L=o(k),at=r(L,!0);s(L);var N=o(L),st=r(N,!0);s(N);var j=o(N),rt=r(j);{var ot=c=>{var q=Dt();p(c,q)},it=(c,q)=>{{var dt=u=>{var F=At();p(u,F)},nt=u=>{var F=Pt();p(u,F)};J(c,u=>{t(a).status==="Pending"?u(dt):u(nt,!1)},q)}};J(rt,c=>{t(a).status==="Completed"?c(ot):c(it,!1)})}s(j);var H=o(j),lt=r(H);s(H),s(l),pt(()=>{w(tt,t(a).patientName),w(et,t(a).date||"-"),w(at,t(a).time||"-"),w(st,t(a).doctor||"-")}),f("click",lt,()=>Z(t(a).id)),p(e,l)}),s(G),s(E),s(z),s(Q),s(S),xt(A,()=>t(d),e=>b(d,e)),f("click",I,()=>x("patientName")),f("click",M,()=>x("date")),f("click",T,()=>x("status")),f("click",$,()=>x("Doctor")),p(X,S),vt()}export{Et as component};
