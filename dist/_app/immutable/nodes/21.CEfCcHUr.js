import{t as p,a as n}from"../chunks/OnU_l3An.js";import"../chunks/BsN24l2h.js";import{p as gt,a as mt,s as l,m as y,o as s,j as a,k as e,r as t,t as F,q as _t}from"../chunks/FB_gRupF.js";import{s as o}from"../chunks/BkxHr61Q.js";import{i as L}from"../chunks/BydVSvHb.js";import{e as ht,i as bt}from"../chunks/BWNo7gSO.js";import{i as ut}from"../chunks/0NZHIKlb.js";import{o as yt,a as wt}from"../chunks/SaxHpMRh.js";import{j as Nt,i as At,e as Mt,d as z,o as G,q as St,c as jt,w as J}from"../chunks/CLR_ZPnl.js";var kt=p('<div class="text-center py-8"><div class="text-xl text-gray-400">Loading medical record...</div></div>'),qt=p('<div class="text-center py-8"><div class="text-xl text-red-400"> </div></div>'),Dt=p('<p class="text-lg text-gray-300">No prescriptions found</p>'),Pt=p('<tr class="border-t border-gray-700"><td class="py-4"> </td><td class="py-4"> </td><td class="py-4"> </td></tr>'),Rt=p('<div class="bg-[#2c2c2c] rounded-xl shadow-md p-6 w-full"><table class="w-full table table-base"><thead><tr class="text-left text-gray-400"><th class="pb-4">Medicine</th><th class="pb-4">Quantity</th><th class="pb-4">Date Prescribed</th></tr></thead><tbody class="text-gray-300"></tbody></table></div>'),Et=p('<div class="text-lg flex flex-row"><div class="w-[60%]"><div class="grid grid-cols-1 space-x-9 md:grid-cols-2 gap-6 text-lg text-gray-300"><div><span class="font-bold">Name:</span> </div> <div><span class="font-bold">Age:</span> </div> <div><span class="font-bold">Sex:</span> </div> <div><span class="font-bold">Blood Type:</span> </div> <div><span class="font-bold">Weight:</span> </div> <div><span class="font-bold">Height:</span> </div> <div><span class="font-bold">Allergies:</span> </div></div> <div class="mt-6"><h2 class="text-xl font-bold text-gray-400 mb-2">Medical Notes</h2> <p class="text-lg text-gray-300 leading-relaxed"> </p></div></div> <div class="mt-2 items-start justify-start flex flex-col w-[40%]"><h2 class="text-xl font-bold text-gray-400 mb-4">Prescriptions</h2> <!></div></div>'),Tt=p('<div class="space-y-6 w-full mx-auto p-10"><div class="flex justify-between items-center"><h1 class="text-4xl font-extrabold tracking-tight text-white">My Medical Record</h1></div> <!></div>');function Wt(K,O){gt(O,!1);let i=y({patientName:"",age:"",sex:"",bloodType:"",weight:0,height:0,allergies:"",medicalNotes:""}),w=y([]),g=y(!0),m=y(null),N,A;yt(()=>{const v=Nt();At(v,async c=>{if(!c){l(m,"Please login to view your medical record"),l(g,!1);return}try{const _=Mt(z,"record",c.uid);N=G(_,r=>{r.exists()&&l(i,{...s(i),...r.data()}),l(g,!1)},r=>{console.error("Error fetching medical record:",r),l(m,"Failed to load medical record"),l(g,!1)});const S=St(jt(z,"bills"),J("patientId","==",c.uid),J("type","==","prescription"));A=G(S,r=>{l(w,r.docs.map(d=>({id:d.id,...d.data()})))},r=>{console.error("Error fetching prescriptions:",r)})}catch(_){console.error("Error in setup:",_),l(m,"Failed to setup data listeners"),l(g,!1)}})}),wt(()=>{N&&N(),A&&A()}),ut();var M=Tt(),V=a(e(M),2);{var X=v=>{var c=kt();n(v,c)},Y=(v,c)=>{{var _=r=>{var d=qt(),x=e(d),h=e(x,!0);t(x),t(d),F(()=>o(h,s(m))),n(r,d)},S=r=>{var d=Et(),x=e(d),h=e(x),j=e(h),Z=a(e(j));t(j);var k=a(j,2),tt=a(e(k));t(k);var q=a(k,2),et=a(e(q));t(q);var D=a(q,2),at=a(e(D));t(D);var P=a(D,2),st=a(e(P));t(P);var R=a(P,2),rt=a(e(R));t(R);var Q=a(R,2),it=a(e(Q));t(Q),t(h);var B=a(h,2),C=a(e(B),2),ot=e(C,!0);t(C),t(B),t(x);var H=a(x,2),dt=a(e(H),2);{var lt=f=>{var b=Dt();n(f,b)},vt=f=>{var b=Rt(),I=e(b),U=a(e(I));ht(U,5,()=>s(w),bt,(ct,u)=>{var E=Pt(),T=e(E),nt=e(T,!0);t(T);var $=a(T),pt=e($,!0);t($);var W=a($),xt=e(W,!0);t(W),t(E),F(ft=>{o(nt,s(u).medicineName||"-"),o(pt,s(u).itemAmount||"-"),o(xt,ft)},[()=>s(u).createdAt?new Date(s(u).createdAt.seconds*1e3).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}):"-"],_t),n(ct,E)}),t(U),t(I),t(b),n(f,b)};L(dt,f=>{s(w).length===0?f(lt):f(vt,!1)})}t(H),t(d),F(()=>{o(Z,` ${s(i).name||"Not set"}`),o(tt,` ${s(i).age||"Not set"}`),o(et,` ${s(i).sex||"Not set"}`),o(at,` ${s(i).bloodType||"Not set"}`),o(st,` ${s(i).weight?`${s(i).weight} kg`:"Not set"}`),o(rt,` ${s(i).height?`${s(i).height} cm`:"Not set"}`),o(it,` ${s(i).allergies||"None recorded"}`),o(ot,s(i).medicalNotes||"No medical notes available")}),n(r,d)};L(v,r=>{s(m)?r(_):r(S,!1)},c)}};L(V,v=>{s(g)?v(X):v(Y,!1)})}t(M),n(K,M),mt()}export{Wt as component};
